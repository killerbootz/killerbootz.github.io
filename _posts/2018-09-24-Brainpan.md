---
layout: post
title: Brainpan Walkthrough
published: true
---
I've had [Brainpan](https://www.vulnhub.com/entry/brainpan-1,51/) downloaded for awhile and for some reason I haven't ran it, so having a couple of hours last night I decided to see what it was all about. Unbeknownst to me, it was exactly what I was needing...  



 
      ****Spoiler Alert****          ****Spoiler Alert****



I had been wanting to practice buffer overflows for my upcoming OSCP test, and have been working on getting Windows machine setup just for this running [vulnserver](https://github.com/stephenbradshaw/vulnserver) or something similar. As you will shortly see, this machine has that and a bit more.   

****Initial Enum****

![Brainpan NmapOutput1]({{ site.url }}/images/Brainpan/nmap1.JPG)  
![Brainpan NmapOutput2]({{ site.url }}/images/Brainpan/nmap2.JPG) 

We have an unknown service on TCP/9999 and the Python SimpleHTTPServer module running on TCP/10000. Let's see what's happening on the web service:  

![Brainpan Base_Page]({{ site.url }}/images/Brainpan/base_page_10000.JPG)  

Err, ok. A little on the nose here huh? The source shows that this is only an infographic image being hosted.  
Let's hit TCP/9999 with NetCat and see what that's all about:  

![Brainpan access_9999]({{ site.url }}/images/Brainpan/access_9999.JPG)  

Hmm, not much here either. We need more info. Let's go back to the web service and enumerate further using Nikto.  

![Brainpan Nikto]({{ site.url }}/images/Brainpan/nikto.JPG)  

Cool, we have an extra directory that we can test out ("/bin/"). We'll check that out:  

![Brainpan EXE]({{ site.url }}/images/Brainpan/EXE.JPG) 

Since we're being given the brainpan executable here, let's see if we can find the password for the service.

![Brainpan pass]({{ site.url }}/images/Brainpan/brainscan-exe_pass.JPG) 

I'm not a very good coder.....but I'll bet that's the password. 

![Brainpan granted]({{ site.url }}/images/Brainpan/brainpan_access_granted.JPG) 

Awesome. We've cracked the app and are granted access to.....um....well. Yeah nothing. No menu, shell, or extra ports were opened by using the password (must still be in development). So since it's still a service running on the remote server, why not run it locally and see if we can crash it?  

****Buffer Overflow****

One of the best resources for learning about stack-based buffer overflows is [dostackbufferoverflowgood](https://github.com/justinsteven/dostackbufferoverflowgood). I won't go over all the steps or explain all the scrpt options here, but much of my scripts used is from that short course, just a bit modified (highly recommend going through). Moving on...

We can run brainpan.exe using Wine (Windows Emulator) and then use a simple Python script to send an increasing number of "A's" into the password field to attempt to trigger a crash. That will tell us whether or not the application is susceptible to a buffer overflow attack.



![Brainpan BOF_Trigger]({{ site.url }}/images/Brainpan/bof_trigger.JPG) 

Bingo! We're able to crash the application, almost immediately at 900 bytes.  
Once we have the crash byte count, we can restart the app, and attach our debugger ([Immunity](https://www.immunityinc.com/products/debugger/)) to the process for further analysis. 
