---
layout: post
title: Bulldog2 Walkthrough
published: true
---
This is a walkthrough of the CTF machine "Bulldog2" on [Vulnhub](https://www.vulnhub.com/entry/bulldog-2,246/). For me this was a challenging VM to beat! I like one's like these because they challenge me while still being enjoyable.

****Spoiler Alert**** ****Spoiler Alert**** ****Spoiler Alert ****

So after initial bootup we grab the IP and perform the obligatory nmap scan:

![Bulldog2 NmapOutput]({{ site.url }}/images/Bulldog2/nmap.JPG)

Looks like slim pickings with a single website. Let's take a look at Bulldog.social:

![Bulldog2 Page]({{ site.url }}/images/Bulldog2/page.JPG)

Nice. Another social media site selling data to vendors. 
If we look at the source we see that the site references several JavaScript files. The "main" one looks interesting as it references several functions and even paths that Nikto and Dirb didn't find. From this we're able to find the path to extract all of Bulldog.social users:

http://x.x.x.x/users/getUsers?limit= 

Unfortunately, no passwords were included in the output. No problem, if we run the login process through Burp Suite we have the option to copy as a Curl command. From that I was able to piece together a very dirty "quick crack" script:

![Bulldog2 QuickCrack]({{ site.url }}/images/Bulldog2/quickcrack_script.JPG)

Since we're getting JSON output back on failed authentications as "false", searching the output for any "true" indicators will result in a successful authentication. After only a few changes of password, we have a winner:

![Bulldog2 CrackedUser]({{ site.url }}/images/Bulldog2/crackeduser.JPG)

So upon logging into the horochette account with the password we specified in the Curl script previously we weren't really presented with much to work with, or were we? Looking back at the image above we can see we have a few pices of info. A token (JWT), and some other identifying pieces of information on the user, in addition to the users "auth_level".

I knew I had seen this somewhere before and sure enough, going back to the main JavaScript file and searching it we can see the following:

![Bulldog2 MasterAdmin]({{ site.url }}/images/Bulldog2/masteradmin.JPG)


So why not try to change it via FireBug?

![Bulldog2 ChangeToAdmin]({{ site.url }}/images/Bulldog2/changetoadmin.JPG)

Once we refresh, we are presented with a new "Admin" option. WoHoo!

![Bulldog2 AdminPanel]({{ site.url }}/images/Bulldog2/adminpanel.JPG)

....With a separate authentication dialog  :-(
